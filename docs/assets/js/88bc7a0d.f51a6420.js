"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8482],{28453:(e,s,i)=>{i.d(s,{R:()=>o,x:()=>c});var n=i(96540);const t={},r=n.createContext(t);function o(e){const s=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(r.Provider,{value:s},e.children)}},62948:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"manual/Physics","title":"Physics","description":"Physics in XR Blocks is powered by the Rapier physics engine.","source":"@site/docs/manual/Physics.md","sourceDirName":"manual","slug":"/manual/Physics","permalink":"/docs/manual/Physics","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Depth","permalink":"/docs/manual/Depth"},"next":{"title":"Simulator","permalink":"/docs/manual/Simulator"}}');var t=i(74848),r=i(28453);const o={sidebar_position:6},c=void 0,a={},l=[{value:"Getting started",id:"getting-started",level:2},{value:"TypeScript Setup",id:"typescript-setup",level:3},{value:"Physics",id:"physics",level:2},{value:"Adding physics to objects",id:"adding-physics-to-objects",level:2},{value:"Physics Options",id:"physics-options",level:2}];function d(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p,{children:["Physics in XR Blocks is powered by the ",(0,t.jsx)(s.a,{href:"https://rapier.rs/",children:"Rapier physics engine"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"getting-started",children:"Getting started"}),"\n",(0,t.jsx)(s.p,{children:"To use physics in your scene, import the RAPIER physics engine, then pass the RAPIER component into the physics options:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"import * as xb from 'xrblocks';\nimport RAPIER from '@dimforge/rapier3d-simd-compat';\n\nconst options = new xb.Options();\noptions.physics.RAPIER = RAPIER;\nxb.init(options);\n"})}),"\n",(0,t.jsxs)(s.p,{children:["See ",(0,t.jsx)(s.a,{href:"/samples/Ballpit/",children:"/samples/Ballpit"})," and ",(0,t.jsx)(s.a,{href:"/samples/Drone",children:"/samples/Drone"})," for examples of using physics."]}),"\n",(0,t.jsx)(s.h3,{id:"typescript-setup",children:"TypeScript Setup"}),"\n",(0,t.jsxs)(s.p,{children:["The Rapier physics library comes in several different variants such as ",(0,t.jsx)(s.a,{href:"https://www.npmjs.com/package/@dimforge/rapier3d",children:"@dimforge/rapier3d"})," and ",(0,t.jsx)(s.a,{href:"https://www.npmjs.com/package/@dimforge/rapier3d-simd-compat",children:"@dimforge/rapier3d-simd-compat"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["XR Blocks supports the different 3D variants of RAPIER by using a virtual import ",(0,t.jsx)(s.code,{children:"rapier3d"})," for types instead of directly importing from one of the specific packages. When using TypeScript, you will need to link the virtual import to your installed version of Rapier. For example, when using ",(0,t.jsx)(s.a,{href:"https://www.npmjs.com/package/@dimforge/rapier3d-simd-compat",children:"@dimforge/rapier3d-simd-compat"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",metastring:'title="tsconfig.json"',children:'{\n  "compilerOptions": {\n    "paths": {\n      "rapier3d": ["./node_modules/@dimforge/rapier3d-simd-compat/rapier"]\n    }\n  }\n  //...\n}\n'})}),"\n",(0,t.jsx)(s.h2,{id:"physics",children:"Physics"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.a,{href:"/api/classes/Physics",children:(0,t.jsx)(s.code,{children:"Physics"})})," controller will initialize ",(0,t.jsx)(s.code,{children:"RAPIER"}),", create a RAPIER world, and call ",(0,t.jsx)(s.a,{href:"https://rapier.rs/javascript3d/classes/World.html#step",children:(0,t.jsx)(s.code,{children:"world.step"})})," for every physics step.\nIs is accessible from ",(0,t.jsx)(s.code,{children:"xb.core.physics"})," and has the following properties:"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"RAPIER"})," - the global ",(0,t.jsx)(s.code,{children:"RAPIER"})," object."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"blendedWorld"})," - the global ",(0,t.jsx)(s.code,{children:"RAPIER.world"})," object."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"fps"})," - the fixed physics update rate."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"options"})," - physics options."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"adding-physics-to-objects",children:"Adding physics to objects"}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.a,{href:"/api/classes/Script#initphysics",children:(0,t.jsx)(s.code,{children:"Script.initPhysics"})})," method, you can create rigid bodies corresponding to your object.\nThen in the ",(0,t.jsx)(s.a,{href:"/api/classes/Script#physicsstep",children:(0,t.jsx)(s.code,{children:"Script.physicsStep"})})," method, copy the translation and rotation of the rigid body to your object."]}),"\n",(0,t.jsx)(s.p,{children:"For example:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"export class Ball extends xb.Script {\n  //...\n\n  initPhysics(physics) {\n    const RAPIER = physics.RAPIER;\n    const desc = RAPIER.RigidBodyDesc.dynamic().setTranslation(\n      ...this.position\n    );\n    const shape = RAPIER.ColliderDesc.ball(this.radius);\n    this.body = world.createRigidBody(desc);\n    this.collider = world.createCollider(shape, this.body);\n  }\n\n  physicsStep() {\n    this.position.copy(this.body.translation());\n    this.quaternion.copy(this.body.rotation());\n  }\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"physics-options",children:"Physics Options"}),"\n",(0,t.jsxs)(s.p,{children:["By default, we uses the following options in ",(0,t.jsx)(s.a,{href:"/api/classes/PhysicsOptions",children:(0,t.jsx)(s.code,{children:"PhysicsOptions"})})," in the initial ",(0,t.jsx)(s.a,{href:"/api/functions/init",children:(0,t.jsx)(s.code,{children:"xb.init"})})," call:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"{\n  fps: 45,\n  gravity: {x: 0.0, y: -9.81, z: 0.0},\n  // Have `Physics` automatically call world.step.\n  worldStep: true,\n  // Use an event queue when calling world.step.\n  useEventQueue: false\n};\n"})})]})}function p(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);